parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"Focm":[function(require,module,exports) {
function t(t,a){return n(t)||r(t,a)||e()}function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(u){a=!0,i=u}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}function n(t){if(Array.isArray(t))return t}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}var l=function(){function e(){a(this,e)}return o(e,[{key:"deserializeAnnotation",value:function(e){var r=this.constructor.attributeMap,n=e.split(","),a={},i=!0,o=!1,l=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var y=t(u.value.split("="),2),c=y[0],g=y[1],p=this.getKeyByValue(r,c),h="";h="text"===p||"actionType"===p||"actionUrl"===p||"type"===p||"style"===p?decodeURIComponent(g):parseFloat(g,10),a[p]=h}}catch(v){o=!0,l=v}finally{try{i||null==s.return||s.return()}finally{if(o)throw l}}return a}},{key:"serializeAnnotation",value:function(t){var e=this.constructor.attributeMap,r="";for(var n in t){var a=e[n];if(("text"===n||"actionType"===n||"actionUrl"===n)&&a&&t.hasOwnProperty(n)){var i=encodeURIComponent(t[n]);r+="".concat(a,"=").concat(i,",")}else a&&t.hasOwnProperty(n)&&"text"!==n&&"actionType"!==n&&"actionUrl"!==n&&(r+="".concat(a,"=").concat(t[n],","))}return r.substring(0,r.length-1)}},{key:"deserializeAnnotationList",value:function(t){var e=t.split(";");e.length=e.length-1;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var u=o.value;r.push(this.deserializeAnnotation(u))}}catch(s){a=!0,i=s}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}},{key:"serializeAnnotationList",value:function(t){var e="",r=!0,n=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var l=i.value;e+=this.serializeAnnotation(l)+";"}}catch(u){n=!0,a=u}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"xmlToDom",value:function(t){return(new DOMParser).parseFromString(t,"application/xml")}},{key:"getAnnotationsFromXml",value:function(t){return this.xmlToDom(t).getElementsByTagName("annotation")}},{key:"parseYoutubeAnnotationList",value:function(t){var e=[],r=!0,n=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var l=i.value,u=this.parseYoutubeAnnotation(l);u&&e.push(u)}}catch(s){n=!0,a=s}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"parseYoutubeAnnotation",value:function(t){var e=t,r=this.getAttributesFromBase(e);if(!r.type||"pause"===r.type)return null;var n=this.getTextFromBase(e),a=this.getActionFromBase(e),i=this.getBackgroundShapeFromBase(e);if(!i)return null;var o=i.timeRange.start,l=i.timeRange.end;if(isNaN(o)||isNaN(l)||null===o||null===l)return null;var u=this.getAppearanceFromBase(e),s={type:r.type,x:i.x,y:i.y,width:i.width,height:i.height,timeStart:o,timeEnd:l};return r.style&&(s.style=r.style),n&&(s.text=n),a&&(s=Object.assign(a,s)),u&&(s=Object.assign(u,s)),i.hasOwnProperty("sx")&&(s.sx=i.sx),i.hasOwnProperty("sy")&&(s.sy=i.sy),s}},{key:"getBackgroundShapeFromBase",value:function(t){var e=t.getElementsByTagName("movingRegion")[0];if(!e)return null;var r=e.getAttribute("type"),n=e.getElementsByTagName("".concat(r,"Region")),a=this.extractRegionTime(n),i={type:r,x:parseFloat(n[0].getAttribute("x"),10),y:parseFloat(n[0].getAttribute("y"),10),width:parseFloat(n[0].getAttribute("w"),10),height:parseFloat(n[0].getAttribute("h"),10),timeRange:a},o=n[0].getAttribute("sx"),l=n[0].getAttribute("sy");return o&&(i.sx=parseFloat(o,10)),l&&(i.sy=parseFloat(l,10)),i}},{key:"getAttributesFromBase",value:function(t){var e={};return e.type=t.getAttribute("type"),e.style=t.getAttribute("style"),e}},{key:"getTextFromBase",value:function(t){var e=t.getElementsByTagName("TEXT")[0];if(e)return e.textContent}},{key:"getActionFromBase",value:function(t){var e=t.getElementsByTagName("action")[0];if(!e)return null;e.getAttribute("type");var r=e.getElementsByTagName("url")[0];if(!r)return null;var n=r.getAttribute("value");if(n.startsWith("https://www.youtube.com/")){var a=new URL(n),i=a.searchParams.get("src_vid"),o=a.searchParams.get("v");return this.linkOrTimestamp(a,i,o)}}},{key:"linkOrTimestamp",value:function(t,e,r){if(e&&r&&e===r){var n=0,a=t.hash;if(a&&a.startsWith("#t=")){var i=t.hash.split("#t=")[1];n=this.timeStringToSeconds(i)}return{actionType:"time",actionSeconds:n}}return{actionType:"url",actionUrl:t.href}}},{key:"getAppearanceFromBase",value:function(t){var e=t.getElementsByTagName("appearance")[0];if(e){var r=e.getAttribute("bgAlpha"),n=e.getAttribute("bgColor"),a=e.getAttribute("fgColor"),i=e.getAttribute("textSize"),o={};return r&&(o.bgOpacity=parseFloat(r,10)),n&&(o.bgColor=parseInt(n,10)),a&&(o.fgColor=parseInt(a,10)),i&&(o.textSize=parseFloat(i,10)),o}}},{key:"extractRegionTime",value:function(t){var e=t[0].getAttribute("t");e=this.hmsToSeconds(e);var r=t[t.length-1].getAttribute("t");return{start:e,end:r=this.hmsToSeconds(r)}}},{key:"hmsToSeconds",value:function(t){for(var e=t.split(":"),r=0,n=1;e.length>0;)r+=n*parseFloat(e.pop(),10),n*=60;return r}},{key:"timeStringToSeconds",value:function(t){var e=0,r=t.split("h"),n=(r[1]||t).split("m"),a=(n[1]||t).split("s");return r[0]&&2===r.length&&(e+=60*parseInt(r[0],10)*60),n[0]&&2===n.length&&(e+=60*parseInt(n[0],10)),a[0]&&2===a.length&&(e+=parseInt(a[0],10)),e}},{key:"getKeyByValue",value:function(t,e){for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e)return r}}],[{key:"attributeMap",get:function(){return{type:"tp",style:"s",x:"x",y:"y",width:"w",height:"h",sx:"sx",sy:"sy",timeStart:"ts",timeEnd:"te",text:"t",actionType:"at",actionUrl:"au",actionSeconds:"as",bgOpacity:"bgo",bgColor:"bgc",fgColor:"fgc",textSize:"txsz"}}}]),e}();window.AnnotationParser=l;
},{}]},{},["Focm"], null)
parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"vKFU":[function(require,module,exports) {

},{}],"onSs":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFinalAnnotationColor=o,exports.decimalToHex=s,exports.NoteAnnotation=exports.default=void 0;var i=function(){function e(n){if(t(this,e),!n)throw new Error("Annotation data must be provided");this.data=n,this.element=document.createElement("div"),this.element.classList.add("__cxt-ar-annotation__"),this.closeElement=this.setupCloseElement(),this.element.append(this.closeElement),this.data.text&&(this.textElement=document.createElement("span"),this.textElement.textContent=this.data.text,this.element.append(this.textElement)),this.setupAppearance(),"speech"!==this.data.style&&"title"!==this.data.style&&this.setupHoverAppearance(),this.element.setAttribute("data-ar-type",this.data.type),this.element.setAttribute("hidden",""),this.textScaling=100,this.paddingMultiplier=1,this.closeButtonScaling=.0423,this.closeButtonOffset=-1.8}return n(e,null,[{key:"defaultAppearanceAttributes",get:function(){return{bgColor:16777215,bgOpacity:.8,fgColor:0,textSize:3.15}}}]),n(e,[{key:"setupCloseElement",value:function(){var t=this,e=this.createCloseElement();return e.addEventListener("click",function(e){t.element.setAttribute("hidden",""),t.element.setAttribute("data-ar-closed","")}),e}},{key:"setupAppearance",value:function(){var t=this.constructor.defaultAppearanceAttributes;isNaN(this.data.textSize)||(t.textSize=this.data.textSize),isNaN(this.data.fgColor)||(t.fgColor=this.data.fgColor),isNaN(this.data.bgColor)||(t.bgColor=this.data.bgColor),this.data.bgColor=t.bgColor,this.data.bgOpacity=t.bgOpacity,this.data.fgColor=t.fgColor,this.data.textSize=t.textSize,this.element.style.color="#"+s(t.fgColor)}},{key:"setupHoverAppearance",value:function(){var t=this,e=this.data,n=e.bgOpacity,i=e.bgColor,s=o(n,i);this.element.style.backgroundColor=s,this.element.addEventListener("mouseenter",function(){t.element.style.backgroundColor=o(n,i,!0),t.closeElement.style.display="block"}),this.element.addEventListener("mouseleave",function(){t.element.style.backgroundColor=o(n,i,!1),t.closeElement.style.display="none"}),"url"===this.data.actionType&&(this.element.style.cursor="pointer")}},{key:"createCloseElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 100 100"),e.classList.add("__cxt-ar-annotation-close__");var n=document.createElementNS(e.namespaceURI,"path");n.setAttribute("d","M25 25 L 75 75 M 75 25 L 25 75"),n.setAttribute("stroke","#bbb"),n.setAttribute("stroke-width",t),n.setAttribute("x",5),n.setAttribute("y",5);var i=document.createElementNS(e.namespaceURI,"circle");return i.setAttribute("cx",50),i.setAttribute("cy",50),i.setAttribute("r",50),e.append(i,n),e}},{key:"show",value:function(){this.element.removeAttribute("hidden")}},{key:"hide",value:function(){this.element.setAttribute("hidden","")}},{key:"updateTextSize",value:function(t){if(this.data.textSize){var e=this.data.textSize/this.textScaling*t;this.fontSize="".concat(e,"px")}}},{key:"updateCloseSize",value:function(t){var e=t*this.closeButtonScaling;this.closeElement.style.width=e+"px",this.closeElement.style.height=e+"px",this.closeElement.style.right=e/this.closeButtonOffset+"px",this.closeElement.style.top=e/this.closeButtonOffset+"px",this.closeButtonSize=e}},{key:"setDimensions",value:function(t,e,n,i){this.left=t,this.top=e,this.width=n,this.height=i}},{key:"setPadding",value:function(t,e){t=t*this.paddingMultiplier+"px",e=e*this.paddingMultiplier+"px",this.element.style.padding="".concat(e," ").concat(t," ").concat(e," ").concat(t)}},{key:"closed",get:function(){return this.element.hasAttribute("data-ar-closed")}},{key:"hidden",get:function(){return this.element.hasAttribute("hidden")}},{key:"type",get:function(){return this.data.type}},{key:"style",get:function(){return this.data.style}},{key:"left",set:function(t){this.element.style.left=t}},{key:"top",set:function(t){this.element.style.top=t}},{key:"width",set:function(t){this.element.style.width=t}},{key:"height",set:function(t){this.element.style.height=t}},{key:"fontSize",set:function(t){this.element.style.fontSize=t}}]),e}();function s(t){var e=t.toString(16);return e="000000".substr(0,6-e.length)+e}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:230;if(!isNaN(t)&&!isNaN(e)){var o=n?i.toString(16):Math.floor(255*t).toString(16),a=s(e);return"#".concat(a).concat(o)}return"#FFFFFFFF"}exports.NoteAnnotation=i;var a=i;exports.default=a;
},{}],"tZXz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("./note.js");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,i){return!i||"object"!==e(i)&&"function"!=typeof i?n(t):i}function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function c(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=function(e){function n(t){var e;return i(this,n),(e=s(this,a(n).call(this,t))).createSpeechBubble(),e.setupHoverAppearance(),e.textX=0,e.textY=0,e.textWidth=0,e.textHeight=0,e.baseStartX=0,e.baseStartY=0,e.baseEndX=0,e.baseEndY=0,e.pointX=0,e.pointY=0,e.directionPadding=20,e.paddingMultiplier=2,e}return h(n,t.NoteAnnotation),c(n,null,[{key:"horizontalBaseStartMultiplier",get:function(){return.17379070765180116}},{key:"horizontalBaseEndMultiplier",get:function(){return.14896346370154384}},{key:"verticalBaseStartMultiplier",get:function(){return.12}},{key:"verticalBaseEndMultiplier",get:function(){return.3}}]),c(n,[{key:"getPointDirection",value:function(t,e,i,s,n,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:20;return n>t+i-i/2&&a>e+s?"br":n<t+i-i/2&&a>e+s?"bl":n>t+i-i/2&&a<e-o?"tr":n<t+i-i/2&&a<e?"tl":n>t+i&&a>e-o&&a<e+s-o?"r":n<t&&a>e&&a<e+s?"l":void 0}},{key:"createSpeechBubble",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"white";this.speechSvg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.speechSvg.classList.add("__cxt-ar-annotation-speech-bubble__"),this.speechSvg.style.position="absolute",this.speechSvg.setAttribute("width","100%"),this.speechSvg.setAttribute("height","100%"),this.speechSvg.style.left="0",this.speechSvg.style.left="0",this.speechSvg.style.display="block",this.speechSvg.style.overflow="visible",this.speechTriangle=document.createElementNS("http://www.w3.org/2000/svg","path"),this.speechTriangle.setAttribute("fill",t),this.speechSvg.append(this.speechTriangle),this.element.prepend(this.speechSvg)}},{key:"updateSpeechBubble",value:function(t,e,i,s,n,a){arguments.length>6&&void 0!==arguments[6]&&arguments[6],arguments.length>7&&void 0!==arguments[7]&&arguments[7];var o=this.constructor.horizontalBaseStartMultiplier,c=this.constructor.horizontalBaseEndMultiplier,h=this.constructor.verticalBaseStartMultiplier,r=this.constructor.verticalBaseEndMultiplier,l=this.getPointDirection(t,e,i,s,n,a,this.directionPadding),p="";if("br"===l)this.baseStartX=i-i*o*2,this.baseEndX=this.baseStartX+i*c,this.baseStartY=s,this.baseEndY=s,this.pointX=n-t,this.pointY=a-e,this.height=a-e+"px",p="L".concat(i," ").concat(s," L").concat(i," 0 L0 0 L0 ").concat(this.baseStartY," L").concat(this.baseStartX," ").concat(this.baseStartY),this.textWidth=i,this.textHeight=s,this.textX=0,this.textY=0;else if("bl"===l)this.baseStartX=i*o,this.baseEndX=this.baseStartX+i*c,this.baseStartY=s,this.baseEndY=s,this.pointX=n-t,this.pointY=a-e,this.height="".concat(a-e,"px"),p="L".concat(i," ").concat(s," L").concat(i," 0 L0 0 L0 ").concat(this.baseStartY," L").concat(this.baseStartX," ").concat(this.baseStartY),this.textWidth=i,this.textHeight=s,this.textX=0,this.textY=0;else if("tr"===l){this.baseStartX=i-i*o*2,this.baseEndX=this.baseStartX+i*c;var u=e-a;this.baseStartY=u,this.baseEndY=u,this.top=e-u+"px",this.height=s+u+"px",this.pointX=n-t,this.pointY=0,p="L".concat(i," ").concat(u," L").concat(i," ").concat(s+u," L0 ").concat(s+u," L0 ").concat(u," L").concat(this.baseStartX," ").concat(this.baseStartY),this.textWidth=i,this.textHeight=s,this.textX=0,this.textY=u}else if("tl"===l){this.baseStartX=i*o,this.baseEndX=this.baseStartX+i*c;var b=e-a;this.baseStartY=b,this.baseEndY=b,this.top=e-b+"px",this.height=s+b+"px",this.pointX=n-t,this.pointY=0,p="L".concat(i," ").concat(b," L").concat(i," ").concat(s+b," L0 ").concat(s+b," L0 ").concat(b," L").concat(this.baseStartX," ").concat(this.baseStartY),this.textWidth=i,this.textHeight=s,this.textX=0,this.textY=b}else if("r"===l){var d=n-(t+i);this.baseStartX=i,this.baseEndX=i,this.width=i+d+"px",this.baseStartY=s*h,this.baseEndY=this.baseStartY+s*r,this.pointX=i+d,this.pointY=a-e,p="L".concat(this.baseStartX," ").concat(s," L0 ").concat(s," L0 0 L").concat(this.baseStartX," 0 L").concat(this.baseStartX," ").concat(this.baseStartY),this.textWidth=i,this.textHeight=s,this.textX=0,this.textY=0}else if("l"===l){var f=t-n;this.baseStartX=f,this.baseEndX=f,this.left=t-f+"px",this.width=i+f+"px",this.baseStartY=s*h,this.baseEndY=this.baseStartY+s*r,this.pointX=0,this.pointY=a-e,p="L".concat(this.baseStartX," ").concat(s," L").concat(i+this.baseStartX," ").concat(s," L").concat(i+this.baseStartX," 0 L").concat(this.baseStartX," 0 L").concat(this.baseStartX," ").concat(this.baseStartY),this.textWidth=i,this.textHeight=s,this.textX=f,this.textY=0}this.textElement&&(this.textElement.style.left=this.textX+"px",this.textElement.style.top=this.textY+"px",this.textElement.style.width=this.textWidth+"px",this.textElement.style.height=this.textHeight+"px"),this.closeElement&&this.closeButtonSize&&(this.closeElement.style.left=this.textX+this.textWidth+this.closeButtonSize/this.closeButtonOffset+"px",this.closeElement.style.top=this.textY+this.closeButtonSize/this.closeButtonOffset+"px");var S="M".concat(this.baseStartX," ").concat(this.baseStartY," L").concat(this.pointX," ").concat(this.pointY," L").concat(this.baseEndX," ").concat(this.baseEndY," ").concat(p);this.speechTriangle.setAttribute("d",S)}},{key:"updateCloseSize",value:function(t){var e=t*this.closeButtonScaling;this.closeElement.style.width=e+"px",this.closeElement.style.height=e+"px",this.closeButtonSize=e}},{key:"setupHoverAppearance",value:function(){var e=this,i=this.data,s=i.bgOpacity,n=i.bgColor;this.speechTriangle.addEventListener("mouseover",function(){e.closeElement.style.display="block",e.closeElement.style.cursor="pointer",e.speechTriangle.setAttribute("fill",(0,t.getFinalAnnotationColor)(s,n,!0))}),this.speechTriangle.addEventListener("mouseout",function(i){i.relatedTarget.classList.contains("__cxt-ar-annotation-close__")||(e.closeElement.style.display="none",e.closeElement.style.cursor="default",e.speechTriangle.setAttribute("fill",(0,t.getFinalAnnotationColor)(s,n,!1)))}),this.closeElement.addEventListener("mouseleave",function(){e.closeElement.style.display="none",e.closeElement.style.cursor="default",e.speechTriangle.style.cursor="default",e.speechTriangle.setAttribute("fill",(0,t.getFinalAnnotationColor)(s,n,!1))}),"url"===this.data.actionType&&(this.element.style.cursor="pointer")}},{key:"setPadding",value:function(t,e){t=t*this.paddingMultiplier+"px",e=e*this.paddingMultiplier+"px",this.textElement.style.padding="".concat(e," ").concat(t," ").concat(e," ").concat(t)}}]),n}();function p(t,e){return t*e/100}var u=l;exports.default=u;
},{"./note.js":"onSs"}],"Focm":[function(require,module,exports) {
"use strict";require("./index.css");var t=n(require("./annotations/note.js")),e=n(require("./annotations/speech.js"));function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var r=function(){function n(t,e,a){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200;if(i(this,n),!t)throw new Error("Annotation objects must be provided");if(!e)throw new Error("An element to contain the annotations must be provided");a&&a.getVideoTime&&a.seekTo?this.playerOptions=a:console.info("AnnotationRenderer is running without a player. The update method will need to be called manually."),this.annotations=[],this.container=e,this.annotationsContainer=document.createElement("div"),this.annotationsContainer.classList.add("__cxt-ar-annotations-container__"),this.annotationsContainer.setAttribute("data-layer","4"),this.annotationsContainer.addEventListener("click",function(t){o.annotationClickHandler(t)}),this.container.prepend(this.annotationsContainer),this.createAnnotationElements(t),this.updateAllAnnotationSizes(),window.addEventListener("DOMContentLoaded",function(t){o.updateAllAnnotationSizes()}),this.updateInterval=r,this.updateIntervalId=null}return o(n,[{key:"changeAnnotationData",value:function(t){this.stop(),this.removeAnnotationElements(),this.annotations=t,this.createAnnotationElements(),this.start()}},{key:"createAnnotationElements",value:function(n){var i=!0,a=!1,o=void 0;try{for(var r,s=n[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value,d=void 0;d="speech"===l.style?new e.default(l):new t.default(l),this.annotations.push(d),this.annotationsContainer.append(d.element)}}catch(u){a=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}},{key:"createCloseElement",value:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("viewBox","0 0 100 100"),t.classList.add("__cxt-ar-annotation-close__");var e=document.createElementNS(t.namespaceURI,"path");e.setAttribute("d","M25 25 L 75 75 M 75 25 L 25 75"),e.setAttribute("stroke","#bbb"),e.setAttribute("stroke-width",10),e.setAttribute("x",5),e.setAttribute("y",5);var n=document.createElementNS(t.namespaceURI,"circle");return n.setAttribute("cx",50),n.setAttribute("cy",50),n.setAttribute("r",50),t.append(n,e),t}},{key:"removeAnnotationElements",value:function(){var t=!0,e=!1,n=void 0;try{for(var i,a=this.annotations[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.element.remove()}}catch(o){e=!0,n=o}finally{try{t||null==a.return||a.return()}finally{if(e)throw n}}}},{key:"update",value:function(t){var e=!0,n=!1,i=void 0;try{for(var a,o=this.annotations[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var r=a.value;if(!r.closed){var s=r.data.timeStart,l=r.data.timeEnd;r.hidden&&t>=s&&t<l?r.show():!r.hidden&&(t<s||t>l)&&r.hide()}}}catch(d){n=!0,i=d}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"start",value:function(){var t=this;if(!this.playerOptions)throw new Error("playerOptions must be provided to use the start method");var e=this.playerOptions.getVideoTime();this.updateIntervalId||(this.update(e),this.updateIntervalId=setInterval(function(){var e=t.playerOptions.getVideoTime();t.update(e),window.dispatchEvent(new CustomEvent("__ar_renderer_start"))},this.updateInterval))}},{key:"stop",value:function(){if(!this.playerOptions)throw new Error("playerOptions must be provided to use the stop method");var t=this.playerOptions.getVideoTime();this.updateIntervalId&&(this.update(t),clearInterval(this.updateIntervalId),this.updateIntervalId=null,window.dispatchEvent(new CustomEvent("__ar_renderer_stop")))}},{key:"updateAnnotationDimensions",value:function(t,e,n){var i=this.container.getBoundingClientRect().width,a=this.container.getBoundingClientRect().height,o=i/e,r=a/n,s=i,l=a;o%1==0&&r%1==0||(o>r?(s=a/n*e,l=a):r>o&&(s=i,l=i/e*n));var d=(i-s)/2/i*100,u=(a-l)/2/a*100,h=s/i,c=l/a,p=!0,v=!1,y=void 0;try{for(var f,m=t[Symbol.iterator]();!(p=(f=m.next()).done);p=!0){var w=f.value,g=d+w.data.x*h,_=u+w.data.y*c,b=w.data.width*h,A=w.data.height*c;w.setDimensions("".concat(g,"%"),"".concat(_,"%"),"".concat(b,"%"),"".concat(A,"%"));var E=.008*s,x=.008*l;if(w.setPadding(E,x),"speech"===w.style&&w.speechSvg){var k=this.percentToPixels(i,g),I=this.percentToPixels(a,_),O=this.percentToPixels(i,b),T=this.percentToPixels(a,A),S=d+w.data.sx*h,C=u+w.data.sy*c;S=this.percentToPixels(i,S),C=this.percentToPixels(a,C),w.updateSpeechBubble(k,I,O,T,S,C,null)}w.updateTextSize(l),w.updateCloseSize(l)}}catch(P){v=!0,y=P}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}}},{key:"updateAllAnnotationSizes",value:function(){if(this.playerOptions&&this.playerOptions.getOriginalVideoWidth&&this.playerOptions.getOriginalVideoHeight){var t=this.playerOptions.getOriginalVideoWidth(),e=this.playerOptions.getOriginalVideoHeight();this.updateAnnotationDimensions(this.annotations,t,e)}else{var n=this.container.getBoundingClientRect().width,i=this.container.getBoundingClientRect().height;this.updateAnnotationDimensions(this.annotations,n,i)}}},{key:"hideAll",value:function(){var t=!0,e=!1,n=void 0;try{for(var i,a=this.annotations[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.hide()}}catch(o){e=!0,n=o}finally{try{t||null==a.return||a.return()}finally{if(e)throw n}}}},{key:"annotationClickHandler",value:function(t){var e=t.target;if(!e.matches(".__cxt-ar-annotation__")&&!e.closest(".__cxt-ar-annotation-close__")&&!(e=e.closest(".__cxt-ar-annotation__")))return null;var n=e.__annotation;if(e&&n)if("time"===n.actionType){var i=n.actionSeconds;if(this.playerOptions){this.playerOptions.seekTo(i);var a=this.playerOptions.getVideoTime();this.update(a)}window.dispatchEvent(new CustomEvent("__ar_seek_to",{detail:{seconds:i}}))}else if("url"===n.actionType){var o={url:n.actionUrl},r=this.extractTimeHash(new URL(o.url));r&&r.hasOwnProperty("seconds")&&(o.seconds=r.seconds),window.dispatchEvent(new CustomEvent("__ar_annotation_click",{detail:o}))}}},{key:"setUpdateInterval",value:function(t){this.updateInterval=t,this.stop(),this.start()}},{key:"extractTimeHash",value:function(t){if(!t)throw new Error("A URL must be provided");var e=t.hash;if(e&&e.startsWith("#t=")){var n=t.hash.split("#t=")[1];return{seconds:this.timeStringToSeconds(n)}}return!1}},{key:"timeStringToSeconds",value:function(t){var e=0,n=t.split("h"),i=(n[1]||t).split("m"),a=(i[1]||t).split("s");return n[0]&&2===n.length&&(e+=60*parseInt(n[0],10)*60),i[0]&&2===i.length&&(e+=60*parseInt(i[0],10)),a[0]&&2===a.length&&(e+=parseInt(a[0],10)),e}},{key:"percentToPixels",value:function(t,e){return t*e/100}}]),n}();window.AnnotationRenderer=r;
},{"./index.css":"vKFU","./annotations/note.js":"onSs","./annotations/speech.js":"tZXz"}]},{},["Focm"], null)
function youtubeAnnotationsPlugin(options) {
	if (!options.annotationXml) throw new Error("Annotation data must be provided");
	if (!options.videoContainer) throw new Error("A video container to overlay the data on must be provided");

	const player = this;

	const xml = options.annotationXml;
	const parser = new AnnotationParser();
	const annotationElements = parser.getAnnotationsFromXml(xml);
	const annotations = parser.parseYoutubeAnnotationList(annotationElements);

	const videoContainer = options.videoContainer;

	const playerOptions = {
		getVideoTime() {
			return player.currentTime();
		},
		seekTo(seconds) {
			player.currentTime(seconds);
		},
		getOriginalVideoWidth() {
			return player.videoWidth();
		},
		getOriginalVideoHeight() {
			return player.videoHeight();
		}
	};

	raiseControls();
	const renderer = new AnnotationRenderer(annotations, videoContainer, playerOptions, options.updateInterval);
	setupEventListeners(player, renderer);
	renderer.start();
}

function setupEventListeners(player, renderer) {
	if (!player) throw new Error("A video player must be provided");
	// should be throttled for performance
	window.addEventListener("resize", e => {
		renderer.updateAllAnnotationSizes(renderer.annotations);
	});

	player.on("pause", e => {
		renderer.stop();
	});
	player.on("play", e => {
		renderer.start();
	});
	player.on("seeking", e => {
		renderer.update();
	});
	player.on("seeked", e => {
		renderer.update();
	});
}

function raiseControls() {
	const styles = document.createElement("style");
	styles.textContent = `
	.vjs-control-bar {
		z-index: 21;
	}
	`;
	document.body.append(styles);
}
